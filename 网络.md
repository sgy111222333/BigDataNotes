# OSI七层模型

开放式系统互联通信参考模型，是ISO组织研究的网络互联模型

七层：物理层，数据链路层，网络层，传输层，会话层，表示层，应用层

TCP/IP五层模型：物理层、数据链路层、网络层、传输层、应用层

TCP/IP四层模型：网络接口层、网络层、传输层、应用层

![image-20220308153420145](C:\Users\sgy11\AppData\Roaming\Typora\typora-user-images\image-20220308153420145.png)

![image-20220308153444912](C:\Users\sgy11\AppData\Roaming\Typora\typora-user-images\image-20220308153444912.png)

## 1.物理层

设备：双绞线、光纤、无线电波、中继器（放大器）、集线器

**主要协议：**IEEE 802.1、IEEE802.3、Ethernet

基本数据单位：比特（bit）

## 2.数据链路层

将来自网络层的数据可靠地传输到目标机的网络层，**在不可靠的物理介质上提供可靠的传输**

作用：MAC地址寻址、数据的成帧、流量控制、数据检错、重发

设备：**交换机**、网桥

主要协议：PPTP、L2TP、**IEEE 802.3、PPP**

基本数据单位：帧（最长1500字节）

**帧格式：**帧头+帧数据，帧头包括MAC地址和其他网络信息

## 3.网络层

功能：**逻辑寻址和路由选择**，连接的建立、保持和终止

负责对子网间的数据包进行路由选择

设备：**路由器**，家用路由器相当于三合一：https://www.bilibili.com/video/BV1wY411V7yW

**主要协议：**

**IP**：仅提供不可靠、无连接的传输服务。

**ICMP**：因特网控制报文协议，**ping**使用的就是ICMP协议。

**ARP**：地址解析协议（利用IP地址找到MAC地址）

**RARP**：逆地址解析协议（利用MAC地址找到IP地址）

基本数据单位：分组（数据包）

IPv4：32位，点分十进制，如 192.168.3.244

IPv6：128位，冒分十六进制，如，fe80::3824:5b2b:ba8e:f862	（8组，每组4个16进制数）

MAC：48位，冒分十六进制，如，38:68:93:af:ba:d1						（6组，每组2个16进制数）

## 4.传输层

第一个端到端（主机到主机，端口到端口，服务到服务）的层此。

设备：网关

基本数据单位：分段

协议：**TCP、UDP**

Socket通信

0~1023端口被系统占用，用户只能使用1024~65535的端口号

## 5.会话层

基本数据单位：报文



## 6.表示层





## 7.应用层

**主要协议：**FTP、Telnet、DNS、SMTP、POP3、HTTP

检查服务端口：`telnet 192.168.3.11 8081` 回显connected





## TCP

必须按顺序发，不能跳

ACK只有在第一次握手时不为1



问题：客户端为什么要在TIME_WAIT状态等待2MSL再CLOSE

服务器端在1MSL内没有收到客户端发出的ACK确认报文，就会重发一遍FIN报文。

如果客户端在2MSL（一去一回）内没收到重发的FIN，说明服务端已经收到ACK报文并已进入CLOSE状态

问题：如何消除TIME_WAIT状态



# IP地址

## IP地址的构成

IP地址包含**网络地址**和**主机地址**

同一个物理网络上的所有主机都使用同一个网络ID

网络上的一个主机（包括路由器）有一个主机地址与其对应

## IP地址的分类和格式

# 子网掩码及网络划分

NAT：解决跨网络转发的问题

两台机器，只有将它们的IP地址和子网掩码按位相与后相等，才属于一个子网（局域网）

计算能容纳的主机个数时，要减去主机地址3个ip（网关，任意，广播）（网关可以是路由器、三层交换机、PC）

**比如：**如果有14台主机，分配16是不够的，因为要用到17个主机号，要分配32个（5位）

# MAC地址

# 网络那些事



### ARP

地址解析协议，是**根据IP地址获取物理地址**的一个TCP/IP协议

传输过程中，源\目的**MAC地址改变**，源\目的**IP地址不变**

# 网络设备
